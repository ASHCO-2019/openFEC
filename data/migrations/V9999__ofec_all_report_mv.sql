-- View: public.ofec_all_report_mv

-- This feature branch is a placeholder for sql script used to create ofec_all_report_mv
-- This branch will not be merged for now 
-- The version number is arbituary so it won't interfer real migration
-- This mv includes all F3, F3x and F3p. Union all three forms in one table could fix wrong filers scenario
-- Nighly refresh job is not added to manage.py


DROP MATERIALIZED VIEW IF EXISTS public.ofec_all_report_mv;

CREATE MATERIALIZED VIEW public.ofec_all_report_mv
TABLESPACE pg_default
AS
 WITH report AS (
         SELECT 'F3'::text AS form_type,
            f3.cmte_id,
            f3.cmte_nm,
            f3.cmte_st1,
            f3.cmte_st2,
            f3.cmte_city,
            f3.cmte_st,
            f3.cmte_zip,
            f3.cvg_start_dt AS coverage_start_date,
            f3.cvg_end_dt AS coverage_end_date,
            f3.election_dt,
            f3.election_st,
            f3.election_st_desc,
            f3.receipt_dt,
            f3.rpt_tp,
            f3.rpt_tp_desc,
            f3.rpt_pgi,
            f3.rpt_pgi_desc,
            f3.rpt_yr,
            f3.coh_bop,
            GREATEST(f3.coh_cop_i, f3.coh_cop_ii) AS coh_cop,
            f3.debts_owed_to_cmte,
            f3.debts_owed_by_cmte,
            f3.indv_item_contb_per,
            f3.indv_unitem_contb_per,
            f3.net_contb_per AS net_contb,
            f3.net_contb_ytd,
            f3.net_op_exp_per AS net_op_exp,
            f3.net_op_exp_ytd,
            f3.offsets_to_op_exp_per AS offsets_to_op_exp,
            f3.offsets_to_op_exp_ytd,
            f3.op_exp_per AS op_exp_period,
            f3.op_exp_ytd,
            f3.other_disb_per AS other_disb_period,
            f3.loan_repymts_other_loans_per AS other_loan_repymts,
            f3.loan_repymts_other_loans_ytd AS other_loan_repymts_ytd,
            f3.other_pol_cmte_contb_per,
            f3.other_pol_cmte_contb_ytd,
            f3.other_receipts_per AS other_receipts_period,
            f3.other_receipts_ytd,
            f3.pol_pty_cmte_contb_per,
            f3.pol_pty_cmte_contb_ytd,
            f3.ref_indv_contb_per,
            f3.ref_indv_contb_ytd,
            f3.ref_pol_pty_cmte_contb_per AS ref_pol_pty_cmte_contb,
            f3.ref_pol_pty_cmte_contb_ytd,
            f3.ref_other_pol_cmte_contb_per AS ref_other_poly_cmte_contb_period,
            f3.ref_other_pol_cmte_contb_ytd,
            f3.subttl_per AS subtotal_summary,
            NULL::numeric AS subttl_sum_ytd,
            f3.tranf_from_other_auth_cmte_per AS transfer_from,
            f3.tranf_from_other_auth_cmte_ytd AS transfer_from_ytd,
            f3.tranf_to_other_auth_cmte_per AS transfer_to,
            f3.tranf_to_other_auth_cmte_ytd AS transfer_to_ytd,
            f3.ttl_contb_per AS ttl_contb,
            f3.ttl_contb_ytd,
            f3.ttl_contb_ref_per AS ttl_contb_refund,
            f3.ttl_contb_ref_ytd,
            GREATEST(f3.ttl_disb_per_i, f3.ttl_disb_per_ii) AS ttl_disb,
            f3.ttl_disb_ytd,
            f3.ttl_indv_contb_per AS ttl_indiv_contb_per,
            f3.ttl_indv_contb_ytd,
            f3.ttl_indv_item_contb_ytd,
            f3.ttl_indv_unitem_contb_ytd,
            f3.ttl_loan_repymts_per AS ttl_loan_repayment,
            f3.ttl_loan_repymts_ytd,
            GREATEST(f3.ttl_receipts_per_i, f3.ttl_receipts_ii) AS ttl_receipts_per,
            f3.ttl_receipts_ytd,
            f3.amndt_ind,
            f3.amndt_ind_desc,
            f3.begin_image_num,
            f3.end_image_num,
            f3.file_num,
            f3.all_other_loans_per AS all_other_loan_period,
            f3.all_other_loans_ytd AS all_other_loan_ytd,
            f3.agr_amt_contrib_pers_fund_prim,
            f3.agr_amt_pers_contrib_gen,
            NULL::numeric AS calendar_yr,
            f3.cand_contb_per AS cand_contb_period,
            f3.cand_contb_ytd,
            f3.loan_repymts_cand_loans_per AS cand_loan_repymnt_period,
            f3.loan_repymts_cand_loans_ytd AS cand_loan_repymnt_ytd,
            NULL::numeric AS coh_begin_calendar_yr,
            NULL::numeric AS coh_coy,
            NULL::numeric AS coord_exp_by_pty_cmte_period,
            NULL::numeric AS coord_exp_by_pty_cmte_ytd,
            NULL::numeric AS exempt_legal_acctg_disb_per,
            NULL::numeric AS exempt_legal_acctg_disb_ytd,
            NULL::numeric AS exp_subject_limits,
            NULL::numeric AS fed_cand_cmte_contb_period,
            NULL::numeric AS fed_cand_cmte_contb_ytd,
            NULL::numeric AS fed_cand_cmte_contb_ref_ytd,
            NULL::numeric AS fed_candidate_contribution_refund_period,
            NULL::numeric AS fed_funds_per,
            NULL::numeric AS fed_funds_ytd,
            NULL::numeric AS fndrsg_disb_per,
            NULL::numeric AS fndrsg_disb_ytd,
            f3.grs_rcpt_auth_cmte_gen,
            f3.grs_rcpt_auth_cmte_prim,
            f3.grs_rcpt_min_pers_contrib_gen,
            f3.grs_rcpt_min_pers_contrib_prim,
            NULL::numeric AS indt_expt_period,
            NULL::numeric AS indt_exp_ytd,
            NULL::numeric AS items_on_hand_liquidated,
            f3.loans_made_by_cand_per AS loan_made_period,
            f3.loans_made_by_cand_ytd AS loan_made_ytd,
            NULL::numeric AS non_alloc_fed_elect_actvy_period,
            NULL::numeric AS non_alloc_fed_elect_actvy_ytd,
            NULL::numeric AS offsets_to_fndrsg_exp_per,
            NULL::numeric AS offsets_to_fndrsg_exp_ytd,
            NULL::numeric AS offsets_to_legal_acctg_per,
            NULL::numeric AS offsets_to_legal_acctg_ytd,
            NULL::numeric AS other_fed_op_exp_period,
            NULL::numeric AS other_fed_op_exp_ytd,
            f3.ref_ttl_contb_col_ttl_ytd,
            NULL::numeric AS shared_fed_actvy_fed_shr_period,
            NULL::numeric AS shared_fed_actvy_fed_shr_ytd,
            NULL::numeric AS shared_fed_actvy_nonfed_period,
            NULL::numeric AS shared_fed_op_exp_period,
            NULL::numeric AS shared_fed_op_exp_ytd,
            NULL::numeric AS shared_nonfed_op_exp_period,
            NULL::numeric AS shared_nonfed_op_exp_ytd,
            NULL::numeric AS tranf_from_nonfed_acct_per,
            NULL::numeric AS tranf_from_nonfed_acct_ytd,
            NULL::numeric AS tranf_from_nonfed_levin_per,
            NULL::numeric AS tranf_from_nonfed_levin_ytd,
            f3.ttl_contb_column_ttl_per AS ttl_contb_column_ttl_period,
            NULL::numeric AS ttl_fed_disb_period,
            NULL::numeric AS ttl_fed_disb_ytd,
            NULL::numeric AS ttl_fed_elect_actvy_period,
            NULL::numeric AS ttl_fed_elect_actvy_ytd,
            NULL::numeric AS ttl_fed_op_exp_period,
            NULL::numeric AS ttl_fed_op_exp_ytd,
            NULL::numeric AS ttl_fed_receipts_per,
            NULL::numeric AS ttl_fed_receipts_ytd,
            f3.ttl_loans_per AS ttl_loan_period,
            f3.ttl_loans_ytd AS ttl_loan_ytd,
            NULL::numeric AS ttl_nonfed_transfer_period,
            NULL::numeric AS ttl_nonfed_tranf_ytd,
            f3.ttl_offsets_to_op_exp_per AS ttl_offset_to_op_exp,
            f3.ttl_offsets_to_op_exp_ytd,
            f3.ttl_op_exp_per AS ttl_op_exp,
            f3.ttl_op_exp_ytd,
            NULL::numeric AS ttl_per,
            NULL::numeric AS ttl_ytd,
            f3.sub_id
           FROM disclosure.nml_form_3 f3
          WHERE f3.delete_ind IS NULL
        UNION ALL
         SELECT 'F3X'::text AS form_type,
            f3x.cmte_id,
            f3x.cmte_nm,
            f3x.cmte_st1,
            f3x.cmte_st2,
            f3x.cmte_city,
            f3x.cmte_st,
            f3x.cmte_zip,
            f3x.cvg_start_dt AS coverage_start_date,
            f3x.cvg_end_dt AS coverage_end_date,
            f3x.election_dt,
            f3x.election_st,
            f3x.election_st_desc,
            f3x.receipt_dt,
            f3x.rpt_tp,
            f3x.rpt_tp_desc,
            f3x.rpt_pgi,
            f3x.rpt_pgi_desc,
            f3x.rpt_yr,
            f3x.coh_bop,
            f3x.coh_cop,
            f3x.debts_owed_to_cmte,
            f3x.debts_owed_by_cmte,
            f3x.indv_item_contb_per,
            f3x.indv_unitem_contb_per,
            f3x.net_contb_per AS net_contb,
            f3x.net_contb_ytd,
            f3x.net_op_exp_per AS net_op_exp,
            f3x.net_op_exp_ytd,
            GREATEST(f3x.offsets_to_op_exp_per_i, f3x.offsets_to_op_exp_per_ii) AS offsets_to_op_exp,
            f3x.offsets_to_op_exp_ytd_i AS offsets_to_op_exp_ytd,
            NULL::numeric AS op_exp_period,
            NULL::numeric AS op_exp_ytd,
            f3x.other_disb_per AS other_disb_period,
            NULL::numeric AS other_loan_repymts,
            NULL::numeric AS other_loan_repymts_ytd,
            f3x.other_pol_cmte_contb_per_i AS other_pol_cmte_contb_per,
            f3x.other_pol_cmte_contb_ytd_i AS other_pol_cmte_contb_ytd,
            f3x.other_fed_receipts_per AS other_receipts_period,
            f3x.other_fed_receipts_ytd AS other_receipts_ytd,
            f3x.pol_pty_cmte_contb_per_i AS pol_pty_cmte_contb_per,
            f3x.pol_pty_cmte_contb_ytd_i AS pol_pty_cmte_contb_ytd,
            f3x.indv_contb_ref_per AS ref_indv_contb_per,
            f3x.indv_contb_ref_ytd AS ref_indv_contb_ytd,
            f3x.pol_pty_cmte_contb_per_ii AS ref_pol_pty_cmte_contb,
            f3x.pol_pty_cmte_contb_ytd_ii AS ref_pol_pty_cmte_contb_ytd,
            f3x.other_pol_cmte_contb_per_ii AS ref_other_poly_cmte_contb_period,
            f3x.other_pol_cmte_contb_ytd_ii AS ref_other_pol_cmte_contb_ytd,
            f3x.subttl_sum_page_per AS subtotal_summary,
            f3x.subttl_sum_ytd,
            f3x.tranf_from_affiliated_pty_per AS transfer_from,
            f3x.tranf_from_affiliated_pty_ytd AS transfer_from_ytd,
            f3x.tranf_to_affliliated_cmte_per AS transfer_to,
            f3x.tranf_to_affilitated_cmte_ytd AS transfer_to_ytd,
            f3x.ttl_contb_per AS ttl_contb,
            f3x.ttl_contb_ytd,
            GREATEST(f3x.ttl_contb_ref_per_i, f3x.ttl_contb_ref_per_ii) AS ttl_contb_refund,
            f3x.ttl_contb_ref_ytd_i AS ttl_contb_ref_ytd,
            GREATEST(f3x.ttl_disb_sum_page_per, f3x.ttl_disb_per) AS ttl_disb,
            f3x.ttl_disb_ytd,
            f3x.ttl_indv_contb AS ttl_indiv_contb_per,
            f3x.ttl_indv_contb_ytd,
            f3x.indv_item_contb_ytd AS ttl_indv_item_contb_ytd,
            f3x.indv_unitem_contb_ytd AS ttl_indv_unitem_contb_ytd,
            f3x.loan_repymts_made_per AS ttl_loan_repayment,
            f3x.loan_repymts_made_ytd AS ttl_loan_repymts_ytd,
            GREATEST(f3x.ttl_receipts_sum_page_per, f3x.ttl_receipts_per) AS ttl_receipts_per,
            f3x.ttl_receipts_ytd,
            f3x.amndt_ind,
            f3x.amndt_ind_desc,
            f3x.begin_image_num,
            f3x.end_image_num,
            f3x.file_num,
            NULL::numeric AS all_other_loan_period,
            NULL::numeric AS all_other_loan_ytd,
            NULL::numeric AS agr_amt_contrib_pers_fund_prim,
            NULL::numeric AS agr_amt_pers_contrib_gen,
            f3x.calendar_yr,
            NULL::numeric AS cand_contb_period,
            NULL::numeric AS cand_contb_ytd,
            NULL::numeric AS cand_loan_repymnt_period,
            NULL::numeric AS cand_loan_repymnt_ytd,
            f3x.coh_begin_calendar_yr,
            f3x.coh_coy,
            f3x.coord_exp_by_pty_cmte_per AS coord_exp_by_pty_cmte_period,
            f3x.coord_exp_by_pty_cmte_ytd,
            NULL::numeric AS exempt_legal_acctg_disb_per,
            NULL::numeric AS exempt_legal_acctg_disb_ytd,
            NULL::numeric AS exp_subject_limits,
            f3x.fed_cand_cmte_contb_per AS fed_cand_cmte_contb_period,
            f3x.fed_cand_cmte_contb_ytd,
            f3x.fed_cand_cmte_contb_ref_ytd,
            f3x.fed_cand_contb_ref_per AS fed_candidate_contribution_refund_period,
            NULL::numeric AS fed_funds_per,
            NULL::numeric AS fed_funds_ytd,
            NULL::numeric AS fndrsg_disb_per,
            NULL::numeric AS fndrsg_disb_ytd,
            NULL::numeric AS grs_rcpt_auth_cmte_gen,
            NULL::numeric AS grs_rcpt_auth_cmte_prim,
            NULL::numeric AS grs_rcpt_min_pers_contrib_gen,
            NULL::numeric AS grs_rcpt_min_pers_contrib_prim,
            f3x.indt_exp_per AS indt_expt_period,
            f3x.indt_exp_ytd,
            NULL::numeric AS items_on_hand_liquidated,
            f3x.loans_made_per AS loan_made_period,
            f3x.loans_made_ytd AS loan_made_ytd,
            f3x.non_alloc_fed_elect_actvy_per AS non_alloc_fed_elect_actvy_period,
            f3x.non_alloc_fed_elect_actvy_ytd,
            NULL::numeric AS offsets_to_fndrsg_exp_per,
            NULL::numeric AS offsets_to_fndrsg_exp_ytd,
            NULL::numeric AS offsets_to_legal_acctg_per,
            NULL::numeric AS offsets_to_legal_acctg_ytd,
            f3x.other_fed_op_exp_per AS other_fed_op_exp_period,
            f3x.other_fed_op_exp_ytd,
            NULL::numeric AS ref_ttl_contb_col_ttl_ytd,
            f3x.shared_fed_actvy_fed_shr_per AS shared_fed_actvy_fed_shr_period,
            f3x.shared_fed_actvy_fed_shr_ytd,
            f3x.shared_fed_actvy_nonfed_per AS shared_fed_actvy_nonfed_period,
            f3x.shared_fed_op_exp_per AS shared_fed_op_exp_period,
            f3x.shared_fed_op_exp_ytd,
            f3x.shared_nonfed_op_exp_per AS shared_nonfed_op_exp_period,
            f3x.shared_nonfed_op_exp_ytd,
            f3x.tranf_from_nonfed_acct_per,
            f3x.tranf_from_nonfed_acct_ytd,
            f3x.tranf_from_nonfed_levin_per,
            f3x.tranf_from_nonfed_levin_ytd,
            NULL::numeric AS ttl_contb_column_ttl_period,
            f3x.ttl_fed_disb_per AS ttl_fed_disb_period,
            f3x.ttl_fed_disb_ytd,
            f3x.ttl_fed_elect_actvy_per AS ttl_fed_elect_actvy_period,
            f3x.ttl_fed_elect_actvy_ytd,
            f3x.ttl_fed_op_exp_per AS ttl_fed_op_exp_period,
            f3x.ttl_fed_op_exp_ytd,
            f3x.ttl_fed_receipts_per,
            f3x.ttl_fed_receipts_ytd,
            f3x.all_loans_received_per AS ttl_loan_period,
            f3x.all_loans_received_ytd AS ttl_loan_ytd,
            f3x.ttl_nonfed_tranf_per AS ttl_nonfed_transfer_period,
            f3x.ttl_nonfed_tranf_ytd,
            NULL::numeric AS ttl_offset_to_op_exp,
            NULL::numeric AS ttl_offsets_to_op_exp_ytd,
            f3x.ttl_op_exp_per AS ttl_op_exp,
            f3x.ttl_op_exp_ytd,
            NULL::numeric AS ttl_per,
            NULL::numeric AS ttl_ytd,
            f3x.sub_id
           FROM disclosure.nml_form_3x f3x
          WHERE f3x.delete_ind IS NULL
        UNION ALL
         SELECT 'F3P'::text AS form_type,
            f3p.cmte_id,
            f3p.cmte_nm,
            f3p.cmte_st1,
            f3p.cmte_st2,
            f3p.cmte_city,
            f3p.cmte_st,
            f3p.cmte_zip,
            f3p.cvg_start_dt AS coverage_start_date,
            f3p.cvg_end_dt AS coverage_end_date,
            f3p.election_dt,
            f3p.election_st,
            f3p.election_st_desc,
            f3p.receipt_dt,
            f3p.rpt_tp,
            f3p.rpt_tp_desc,
            f3p.rpt_pgi,
            f3p.rpt_pgi_desc,
            f3p.rpt_yr,
            f3p.coh_bop,
            f3p.coh_cop,
            f3p.debts_owed_to_cmte,
            f3p.debts_owed_by_cmte,
            f3p.indv_item_contb_per,
            f3p.indv_unitem_contb_per,
            f3p.net_contb_sum_page_per AS net_contb,
            NULL::numeric AS net_contb_ytd,
            f3p.net_op_exp_sum_page_per AS net_op_exp,
            NULL::numeric AS net_op_exp_ytd,
            f3p.offsets_to_op_exp_per AS offsets_to_op_exp,
            f3p.offsets_to_op_exp_ytd,
            f3p.op_exp_per AS op_exp_period,
            f3p.op_exp_ytd,
            f3p.other_disb_per AS other_disb_period,
            f3p.repymts_other_loans_per AS other_loan_repymts,
            f3p.repymts_other_loans_ytd AS other_loan_repymts_ytd,
            f3p.other_pol_cmte_contb_per,
            f3p.other_pol_cmte_contb_ytd,
            f3p.other_receipts_per AS other_receipts_period,
            f3p.other_receipts_ytd,
            f3p.pol_pty_cmte_contb_per,
            f3p.pol_pty_cmte_contb_ytd,
            f3p.ref_indv_contb_per,
            f3p.ref_indv_contb_ytd,
            f3p.ref_pol_pty_cmte_contb_per AS ref_pol_pty_cmte_contb,
            f3p.ref_pol_pty_cmte_contb_ytd,
            f3p.ref_other_pol_cmte_contb_per AS ref_other_poly_cmte_contb_period,
            f3p.ref_other_pol_cmte_contb_ytd,
            f3p.subttl_sum_page_per AS subtotal_summary,
            NULL::numeric AS subttl_sum_ytd,
            f3p.tranf_from_affilated_cmte_per AS transfer_from,
            f3p.tranf_from_affiliated_cmte_ytd AS transfer_from_ytd,
            f3p.tranf_to_other_auth_cmte_per AS transfer_to,
            f3p.tranf_to_other_auth_cmte_ytd AS transfer_to_ytd,
            f3p.ttl_contb_per AS ttl_contb,
            f3p.ttl_contb_ytd,
            f3p.ttl_contb_ref_per AS ttl_contb_refund,
            f3p.ttl_contb_ref_ytd,
            GREATEST(f3p.ttl_disb_sum_page_per, f3p.ttl_disb_per) AS ttl_disb,
            f3p.ttl_disb_ytd,
            GREATEST(f3p.ttl_receipts_sum_page_per, f3p.ttl_receipts_per) AS ttl_indiv_contb_per,
            f3p.indv_contb_ytd AS ttl_indv_contb_ytd,
            f3p.indv_item_contb_ytd AS ttl_indv_item_contb_ytd,
            f3p.indv_unitem_contb_ytd AS ttl_indv_unitem_contb_ytd,
            f3p.ttl_loan_repymts_made_per AS ttl_loan_repayment,
            f3p.ttl_loan_repymts_made_ytd AS ttl_loan_repymts_ytd,
            f3p.indv_contb_per AS ttl_receipts_per,
            f3p.ttl_receipts_ytd,
            f3p.amndt_ind,
            f3p.amndt_ind_desc,
            f3p.begin_image_num,
            f3p.end_image_num,
            f3p.file_num,
            f3p.other_loans_received_per AS all_other_loan_period,
            f3p.other_loans_received_ytd AS all_other_loan_ytd,
            NULL::numeric AS agr_amt_contrib_pers_fund_prim,
            NULL::numeric AS agr_amt_pers_contrib_gen,
            NULL::numeric AS calendar_yr,
            f3p.cand_contb_per AS cand_contb_period,
            f3p.cand_contb_ytd,
            f3p.repymts_loans_made_by_cand_per AS cand_loan_repymnt_period,
            f3p.repymts_loans_made_cand_ytd AS cand_loan_repymnt_ytd,
            NULL::numeric AS coh_begin_calendar_yr,
            NULL::numeric AS coh_coy,
            NULL::numeric AS coord_exp_by_pty_cmte_period,
            NULL::numeric AS coord_exp_by_pty_cmte_ytd,
            f3p.exempt_legal_acctg_disb_per,
            f3p.exempt_legal_acctg_disb_ytd,
            f3p.exp_subject_limits,
            NULL::numeric AS fed_cand_cmte_contb_period,
            NULL::numeric AS fed_cand_cmte_contb_ytd,
            NULL::numeric AS fed_cand_cmte_contb_ref_ytd,
            NULL::numeric AS fed_candidate_contribution_refund_period,
            f3p.fed_funds_per,
            f3p.fed_funds_ytd,
            f3p.fndrsg_disb_per,
            f3p.fndrsg_disb_ytd,
            NULL::numeric AS grs_rcpt_auth_cmte_gen,
            NULL::numeric AS grs_rcpt_auth_cmte_prim,
            NULL::numeric AS grs_rcpt_min_pers_contrib_gen,
            NULL::numeric AS grs_rcpt_min_pers_contrib_prim,
            NULL::numeric AS indt_expt_period,
            NULL::numeric AS indt_exp_ytd,
            f3p.items_on_hand_liquidated,
            f3p.loans_received_from_cand_per AS loan_made_period,
            f3p.loans_received_from_cand_ytd AS loan_made_ytd,
            NULL::numeric AS non_alloc_fed_elect_actvy_period,
            NULL::numeric AS non_alloc_fed_elect_actvy_ytd,
            f3p.offsets_to_fndrsg_exp_per,
            f3p.offsets_to_fndrsg_exp_ytd,
            f3p.offsets_to_legal_acctg_per,
            f3p.offsets_to_legal_acctg_ytd,
            NULL::numeric AS other_fed_op_exp_period,
            NULL::numeric AS other_fed_op_exp_ytd,
            NULL::numeric AS ref_ttl_contb_col_ttl_ytd,
            NULL::numeric AS shared_fed_actvy_fed_shr_period,
            NULL::numeric AS shared_fed_actvy_fed_shr_ytd,
            NULL::numeric AS shared_fed_actvy_nonfed_period,
            NULL::numeric AS shared_fed_op_exp_period,
            NULL::numeric AS shared_fed_op_exp_ytd,
            NULL::numeric AS shared_nonfed_op_exp_period,
            NULL::numeric AS shared_nonfed_op_exp_ytd,
            NULL::numeric AS tranf_from_nonfed_acct_per,
            NULL::numeric AS tranf_from_nonfed_acct_ytd,
            NULL::numeric AS tranf_from_nonfed_levin_per,
            NULL::numeric AS tranf_from_nonfed_levin_ytd,
            NULL::numeric AS ttl_contb_column_ttl_period,
            NULL::numeric AS ttl_fed_disb_period,
            NULL::numeric AS ttl_fed_disb_ytd,
            NULL::numeric AS ttl_fed_elect_actvy_period,
            NULL::numeric AS ttl_fed_elect_actvy_ytd,
            NULL::numeric AS ttl_fed_op_exp_period,
            NULL::numeric AS ttl_fed_op_exp_ytd,
            NULL::numeric AS ttl_fed_receipts_per,
            NULL::numeric AS ttl_fed_receipts_ytd,
            f3p.ttl_loans_received_per AS ttl_loan_period,
            f3p.ttl_loans_received_ytd AS ttl_loan_ytd,
            NULL::numeric AS ttl_nonfed_transfer_period,
            NULL::numeric AS ttl_nonfed_tranf_ytd,
            f3p.ttl_offsets_to_op_exp_per AS ttl_offset_to_op_exp,
            f3p.ttl_offsets_to_op_exp_ytd,
            NULL::numeric AS ttl_op_exp,
            NULL::numeric AS ttl_op_exp_ytd,
            f3p.ttl_per,
            f3p.ttl_ytd,
            f3p.sub_id
           FROM disclosure.nml_form_3p f3p
          WHERE f3p.delete_ind IS NULL
        )
 SELECT report.form_type,
    report.cmte_id,
    report.cmte_nm,
    report.cmte_st1,
    report.cmte_st2,
    report.cmte_city,
    report.cmte_st,
    report.cmte_zip,
    report.coverage_start_date,
    report.coverage_end_date,
    report.election_dt,
    report.election_st,
    report.election_st_desc,
    report.receipt_dt,
    report.rpt_tp,
    report.rpt_tp_desc,
    report.rpt_pgi,
    report.rpt_pgi_desc,
    report.rpt_yr,
    report.coh_bop,
    report.coh_cop,
    report.debts_owed_to_cmte,
    report.debts_owed_by_cmte,
    report.indv_item_contb_per,
    report.indv_unitem_contb_per,
    report.net_contb,
    report.net_contb_ytd,
    report.net_op_exp,
    report.net_op_exp_ytd,
    report.offsets_to_op_exp,
    report.offsets_to_op_exp_ytd,
    report.op_exp_period,
    report.op_exp_ytd,
    report.other_disb_period,
    report.other_loan_repymts,
    report.other_loan_repymts_ytd,
    report.other_pol_cmte_contb_per,
    report.other_pol_cmte_contb_ytd,
    report.other_receipts_period,
    report.other_receipts_ytd,
    report.pol_pty_cmte_contb_per,
    report.pol_pty_cmte_contb_ytd,
    report.ref_indv_contb_per,
    report.ref_indv_contb_ytd,
    report.ref_pol_pty_cmte_contb,
    report.ref_pol_pty_cmte_contb_ytd,
    report.ref_other_poly_cmte_contb_period,
    report.ref_other_pol_cmte_contb_ytd,
    report.subtotal_summary,
    report.subttl_sum_ytd,
    report.transfer_from,
    report.transfer_from_ytd,
    report.transfer_to,
    report.transfer_to_ytd,
    report.ttl_contb,
    report.ttl_contb_ytd,
    report.ttl_contb_refund,
    report.ttl_contb_ref_ytd,
    report.ttl_disb,
    report.ttl_disb_ytd,
    report.ttl_indiv_contb_per,
    report.ttl_indv_contb_ytd,
    report.ttl_indv_item_contb_ytd,
    report.ttl_indv_unitem_contb_ytd,
    report.ttl_loan_repayment,
    report.ttl_loan_repymts_ytd,
    report.ttl_receipts_per,
    report.ttl_receipts_ytd,
    report.amndt_ind,
    report.amndt_ind_desc,
    report.begin_image_num,
    report.end_image_num,
    report.file_num,
    report.all_other_loan_period,
    report.all_other_loan_ytd,
    report.agr_amt_contrib_pers_fund_prim,
    report.agr_amt_pers_contrib_gen,
    report.calendar_yr,
    report.cand_contb_period,
    report.cand_contb_ytd,
    report.cand_loan_repymnt_period,
    report.cand_loan_repymnt_ytd,
    report.coh_begin_calendar_yr,
    report.coh_coy,
    report.coord_exp_by_pty_cmte_period,
    report.coord_exp_by_pty_cmte_ytd,
    report.exempt_legal_acctg_disb_per,
    report.exempt_legal_acctg_disb_ytd,
    report.exp_subject_limits,
    report.fed_cand_cmte_contb_period,
    report.fed_cand_cmte_contb_ytd,
    report.fed_cand_cmte_contb_ref_ytd,
    report.fed_candidate_contribution_refund_period,
    report.fed_funds_per,
    report.fed_funds_ytd,
    report.fndrsg_disb_per,
    report.fndrsg_disb_ytd,
    report.grs_rcpt_auth_cmte_gen,
    report.grs_rcpt_auth_cmte_prim,
    report.grs_rcpt_min_pers_contrib_gen,
    report.grs_rcpt_min_pers_contrib_prim,
    report.indt_expt_period,
    report.indt_exp_ytd,
    report.items_on_hand_liquidated,
    report.loan_made_period,
    report.loan_made_ytd,
    report.non_alloc_fed_elect_actvy_period,
    report.non_alloc_fed_elect_actvy_ytd,
    report.offsets_to_fndrsg_exp_per,
    report.offsets_to_fndrsg_exp_ytd,
    report.offsets_to_legal_acctg_per,
    report.offsets_to_legal_acctg_ytd,
    report.other_fed_op_exp_period,
    report.other_fed_op_exp_ytd,
    report.ref_ttl_contb_col_ttl_ytd,
    report.shared_fed_actvy_fed_shr_period,
    report.shared_fed_actvy_fed_shr_ytd,
    report.shared_fed_actvy_nonfed_period,
    report.shared_fed_op_exp_period,
    report.shared_fed_op_exp_ytd,
    report.shared_nonfed_op_exp_period,
    report.shared_nonfed_op_exp_ytd,
    report.tranf_from_nonfed_acct_per,
    report.tranf_from_nonfed_acct_ytd,
    report.tranf_from_nonfed_levin_per,
    report.tranf_from_nonfed_levin_ytd,
    report.ttl_contb_column_ttl_period,
    report.ttl_fed_disb_period,
    report.ttl_fed_disb_ytd,
    report.ttl_fed_elect_actvy_period,
    report.ttl_fed_elect_actvy_ytd,
    report.ttl_fed_op_exp_period,
    report.ttl_fed_op_exp_ytd,
    report.ttl_fed_receipts_per,
    report.ttl_fed_receipts_ytd,
    report.ttl_loan_period,
    report.ttl_loan_ytd,
    report.ttl_nonfed_transfer_period,
    report.ttl_nonfed_tranf_ytd,
    report.ttl_offset_to_op_exp,
    report.ttl_offsets_to_op_exp_ytd,
    report.ttl_op_exp,
    report.ttl_op_exp_ytd,
    report.ttl_per,
    report.ttl_ytd,
    report.sub_id,
    means_filed(report.begin_image_num::text) AS means_filed,
    report_fec_url(report.begin_image_num::text, report.file_num::integer) AS fec_url
   FROM report
WITH DATA;

ALTER TABLE public.ofec_all_report_mv
    OWNER TO fec;

GRANT ALL ON TABLE public.ofec_all_report_mv TO fec;
GRANT SELECT ON TABLE public.ofec_all_report_mv TO fec_read;