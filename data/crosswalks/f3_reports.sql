-- vsum is as amended and has fewer columns
-- this takes the name from sum_and_det_sum_report to


CREATE OR REPLACE VIEW public.fec_vsumcolumns_f3_vw AS
SELECT VS.cmte_id,
vs.cvg_start_dt,
vs.cvg_end_dt,
vs.rpt_yr,
vs.ttl_contb as ttl_contb_per,
vs.ttl_contb_ref as ttl_contb_ref_per,
vs.net_contb as net_contb_per,
vs.op_exp_per as ttl_op_exp_per,
vs.offsets_to_op_exp as ttl_offsets_to_op_exp_per,
vs.net_op_exp as net_op_exp_per,
vs.coh_cop AS coh_cop,
vs.debts_owed_to_cmte,
vs.debts_owed_by_cmte,
vs.indv_item_contb AS indv_item_contb_per,
vs.indv_unitem_contb AS indv_unitem_contb_per,
vs.indv_contb AS ttl_indv_contb_per,
vs.pty_cmte_contb AS pol_pty_cmte_contb_per,
VS.OTH_CMTE_CONTB AS other_pol_cmte_contb_per,
VS.CAND_CNTB AS cand_contb_per,
vs.TTL_CONTB AS ttl_contb_per,
vs.tranf_from_other_auth_cmte AS tranf_from_other_auth_cmte_per,
VS.CAND_LOAN AS loans_made_by_cand_per,
VS.OTH_LOANS AS all_other_loans_per,
VS.TTL_LOANS AS ttl_loans_per,
VS.offsets_to_op_exp AS offsets_to_op_exp_per,
VS.OTHER_RECEIPTS AS other_receipts_per,
VS.ttl_receipts AS ttl_receipts_per,
VS.OP_EXP_PER AS op_exp_per,
VS.tranf_to_other_auth_cmte AS tranf_to_other_auth_cmte_per,
vs.cand_loan_repymnt as loan_repymts_cand_loans_per,
vs.OTH_LOAN_REPYMTS loan_repymts_other_loans_per,
vs.ttl_loan_repymts as ttl_loan_repymts_per,
vs.indv_ref as ref_indv_contb_per,
vs.pol_pty_cmte_contb as ref_pol_pty_cmte_contb_per, -- the vs column name is unfortunate but that's the way it goes
vs.oth_cmte_ref as ref_other_pol_cmte_contb_per,
vs.ttl_contb_ref as ttl_contb_ref_per,
vs.other_disb_per as other_disb_per,
vs.ttl_disb AS ttl_disb_per,
vs.coh_bop,
vs.orig_sub_id as sub_id
FROM disclosure.v_sum_and_det_sum_report vs;