CREATE OR REPLACE VIEW public.fec_vsumcolumns_f3p_vw AS
SELECT VS.cmte_id,
    VS.cvg_start_dt,
    VS.cvg_end_dt,
    VS.rpt_yr,
    VS.receipt_dt,
    VS.rpt_yr + VS.rpt_yr % 2::numeric AS election_cycle,
    VS.coh_bop,
    VS.TTL_RECEIPTS AS ttl_receipts_per,
    VS.TTL_DISB AS ttl_disb_per,
    VS.coh_cop,
    VS.debts_owed_to_cmte,
    VS.debts_owed_by_cmte,
    vs.net_contb as net_contb_per,
    vs.op_exp_per as ttl_op_exp_per,
    VS.fed_funds_per,
    VS.INDV_ITEM_CONTB AS indv_item_contb_per,
    VS.INDV_UNITEM_CONTB AS indv_unitem_contb_per,
    VS.INDV_REF AS ttl_indiv_contb_per, -- UNFORTUNATELY A WRONG NAME IN V_SUM BUT MAPPED NONE THE LESS
    VS.PTY_CMTE_CONTB AS pol_pty_cmte_contb_per,
    VS.OTH_CMTE_CONTB AS other_pol_cmte_contb_per,
    VS.CAND_CNTB AS cand_contb_per,
    VS.TTL_CONTB AS ttl_contb_per,
    VS.TRANF_FROM_OTHER_AUTH_CMTE AS tranf_from_affilated_cmte_per,
    VS.CAND_LOAN AS loans_received_from_cand_per,
    VS.OTH_LOANS AS other_loans_received_per,
    VS.ttl_loans AS ttl_loans_received_per,
    VS.OFFSETS_TO_OP_EXP AS offsets_to_op_exp_per,
    VS.offsets_to_fndrsg AS offsets_to_fndrsg_exp_per,
    VS.OFFSETS_TO_LEGAL_ACCTG AS offsets_to_legal_acctg_per,
    VS.OFFSETS_TO_OP_EXP + VS.offsets_to_fndrsg + VS.OFFSETS_TO_LEGAL_ACCTG AS ttl_offsets_to_op_exp_per,
    VS.OTHER_RECEIPTS AS other_receipts_per,
    VS.OP_EXP_PER AS op_exp_per,
    VS.TRANF_TO_OTHER_AUTH_CMTE AS tranf_to_other_auth_cmte_per,
    VS.FNDRSG_DISB AS fndrsg_disb_per,
    VS.EXEMPT_LEGAL_ACCTG_DISB AS exempt_legal_acctg_disb_per,
    VS.CAND_LOAN_REPYMNT AS repymts_loans_made_by_cand_per,
    VS.OTH_LOAN_REPYMTS AS repymts_other_loans_per,
    VS.CAND_LOAN_REPYMNT + VS.OTH_LOAN_REPYMTS AS ttl_loan_repymts_made_per,
    VS.INDV_REF AS ref_indv_contb_per,
    VS.POL_PTY_CMTE_CONTB AS ref_pol_pty_cmte_contb_per, -- BAD COLUMN NAME IN V_SUM
    VS.OTH_CMTE_REF AS ref_other_pol_cmte_contb_per,
    VS.POL_PTY_CMTE_CONTB + VS.OTH_CMTE_REF AS ttl_contb_ref_per,
    VS.OTHER_DISB_PER AS other_disb_per,
    VS.ORIG_SUB_ID AS sub_id
FROM disclosure.v_sum_and_det_sum_report vs
;
